# whole brain calcium activity analysis

Understanding how the brain works is what neuroscientists striving for. The recent neuroscience technology has allowed to observe the whole brain activity by calcium imaing in c.elegans, larval zebrafish and even soon in drosophila. For example, c.elegans has only around 300 neurons and larval zebrafish has only several thousands neurons. Think about that, right now, you have all the neurons firing dynamics of these animals in hand, can you interpret what these animals are thinking, and what they are gonna do in the next mili-seconds? I guess this is what I am tackling. I hope to figure out how these simple animals assemble various group of neurons to deal with preferred or aversive stimuli. 

This code is just a part of our modeling on whole brain activity analysis. We proposed and implemented a state-space model to characterize not only the correlational structure of brain activity but also its time-series property. Although linear time-invariant state-space model has been commonly used in time-series analysis, we apply it to the whole brain activity analysis dissecting out potential functional subnetworks. A combination of low-rank approximations, L1 and L2 penalties, and some numerical linear algebra tricks, yields an estimator that is computationally efficient and numerically stable. We interpreted the parameters as patterning of the brain dynamics which can cluster group of neurons who fire together. The hidden states in our state-space model are switched by a transition matrix as model parameter to describe how varying brain states evolved from the whole brain time-series activity. As a generalization of the classical Kalman Filter-Smoother Expectation-Maximization algorithm, our state-space model was applied to estimate the spatial filters, connectivity graphs, and time-courses for functional magnetic resonance imaging data and simultaneous functional calcium imaging of neuronal activity at single-neuron resolution in c.elegans and zebrafish larval brains. In summary, we proposed a sparse high dimensional state-space model to characterize the functional structure of whole brain activity trying to extract out the functional subnetworks assembling various population of neurons in response to various behavior paradigm.
